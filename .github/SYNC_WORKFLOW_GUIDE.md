# ä»“åº“åŒæ­¥å·¥ä½œæµä½¿ç”¨æŒ‡å—

## æ¦‚è¿°

è¿™ä¸ª GitHub Actions å·¥ä½œæµç”¨äºå°†ç§æœ‰ä»“åº“çš„æ›´æ”¹åŒæ­¥åˆ°å…¬å…±ä»“åº“ `git@github.com:leafvmaple/zonix.git`ã€‚

## åŠŸèƒ½ç‰¹æ€§

- âœ… å¯¹æ¯”ç§æœ‰ä»“åº“å’Œå…¬å…±ä»“åº“çš„å·®å¼‚
- âœ… æ”¶é›†å·®å¼‚æœŸé—´çš„æ‰€æœ‰æäº¤æ—¥å¿—
- âœ… å°†å¤šä¸ªæäº¤åˆå¹¶ä¸ºä¸€ä¸ªæ€»å’Œæäº¤
- âœ… ç”Ÿæˆè¯¦ç»†çš„å¯¹æ¯”æŠ¥å‘Š
- âœ… æ”¯æŒ Dry Run æ¨¡å¼é¢„è§ˆæ›´æ”¹
- âœ… è‡ªåŠ¨æ¨é€åˆ°å…¬å…±ä»“åº“

## é…ç½®æ­¥éª¤

### 1. ç”Ÿæˆ SSH å¯†é’¥

åœ¨æœ¬åœ°è¿è¡Œä»¥ä¸‹å‘½ä»¤ç”Ÿæˆæ–°çš„ SSH å¯†é’¥å¯¹ï¼š

```bash
ssh-keygen -t ed25519 -C "github-actions-sync" -f ~/.ssh/zonix_sync_key -N ''
```

æˆ–è€…ä¸æŒ‡å®šå¯†ç ï¼ˆä¼šæç¤ºè¾“å…¥ï¼Œç›´æ¥å›è½¦å³å¯ï¼‰ï¼š

```bash
ssh-keygen -t ed25519 -C "github-actions-sync" -f ~/.ssh/zonix_sync_key
```

### 2. é…ç½®å…¬å…±ä»“åº“

1. è®¿é—®å…¬å…±ä»“åº“ï¼šhttps://github.com/leafvmaple/zonix
2. è¿›å…¥ Settings â†’ Deploy keys
3. ç‚¹å‡» "Add deploy key"
4. æ ‡é¢˜ï¼š`Sync from Private Repo`
5. ç²˜è´´å…¬é’¥å†…å®¹ï¼ˆ`~/.ssh/zonix_sync_key.pub`ï¼‰
6. âœ… å‹¾é€‰ "Allow write access"
7. ç‚¹å‡» "Add key"

### 3. é…ç½®ç§æœ‰ä»“åº“

1. è®¿é—®å½“å‰ç§æœ‰ä»“åº“çš„ Settings â†’ Secrets and variables â†’ Actions
2. ç‚¹å‡» "New repository secret"
3. Name: `PUBLIC_REPO_SSH_KEY`
4. Secret: ç²˜è´´ç§é’¥å†…å®¹ï¼ˆ`~/.ssh/zonix_sync_key`ï¼‰
5. ç‚¹å‡» "Add secret"

## ä½¿ç”¨æ–¹æ³•

### æ‰‹åŠ¨è§¦å‘å·¥ä½œæµ

1. è¿›å…¥ä»“åº“çš„ **Actions** æ ‡ç­¾é¡µ
2. é€‰æ‹©å·¦ä¾§çš„ **"Sync to Public Repository"** å·¥ä½œæµ
3. ç‚¹å‡»å³ä¾§çš„ **"Run workflow"** æŒ‰é’®
4. é€‰æ‹©è¿è¡Œæ¨¡å¼ï¼š
   - **`false`** (é»˜è®¤): å®é™…æ‰§è¡ŒåŒæ­¥å¹¶æ¨é€åˆ°å…¬å…±ä»“åº“
   - **`true`**: Dry Run æ¨¡å¼ï¼Œä»…é¢„è§ˆæ›´æ”¹ä¸æ¨é€
5. ç‚¹å‡» **"Run workflow"** ç¡®è®¤è¿è¡Œ

### æŸ¥çœ‹åŒæ­¥ç»“æœ

å·¥ä½œæµè¿è¡Œå®Œæˆåï¼š

1. **Summary æ ‡ç­¾é¡µ**ï¼šæŸ¥çœ‹åŒæ­¥æ¦‚è¦å’Œç»Ÿè®¡ä¿¡æ¯
2. **Artifacts**ï¼šä¸‹è½½ `sync-comparison-report` æŸ¥çœ‹è¯¦ç»†çš„å¯¹æ¯”æŠ¥å‘Š
   - `comparison.md`ï¼šæ–‡ä»¶å·®å¼‚ç»Ÿè®¡å’Œæäº¤å†å²
   - `commit_message.txt`ï¼šç”Ÿæˆçš„åˆå¹¶æäº¤ä¿¡æ¯

## å·¥ä½œæµç¨‹è¯´æ˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç§æœ‰ä»“åº“ (ä¿ç•™å®Œæ•´å†å²)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”œâ”€ 1. è·å–å®Œæ•´å†å²
               â”œâ”€ 2. æ·»åŠ å…¬å…±ä»“åº“ä¸ºè¿œç¨‹
               â”œâ”€ 3. å¯¹æ¯”ä»£ç å·®å¼‚
               â”‚
               â”œâ”€ 4. æ”¶é›†å·®å¼‚æœŸé—´çš„æäº¤æ—¥å¿—
               â”œâ”€ 5. æ±‡æ€»æˆå•ä¸ªæäº¤ä¿¡æ¯
               â”‚
               â”œâ”€ 6. åˆ›å»ºæ–°çš„ç‹¬ç«‹æäº¤ âš¡
               â”‚    (ä¸åŒ…å«å†å²è®°å½•)
               â”‚
               â””â”€ 7. æ¨é€åˆ°å…¬å…±ä»“åº“
                      â”‚
                      â–¼
               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚  å…¬å…±ä»“åº“ (ä»…åˆå¹¶æäº¤)   â”‚
               â”‚  â€¢ ç©ºä»“åº“ï¼š1ä¸ªåˆå§‹æäº¤   â”‚
               â”‚  â€¢ å·²æœ‰å†…å®¹ï¼š+1ä¸ªæ–°æäº¤  â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ”’ éšç§ä¿æŠ¤ä¸è¿‡æ»¤æœºåˆ¶

- âœ… **ä¸æš´éœ²æäº¤å†å²**ï¼šå…¬å…±ä»“åº“ä¸åŒ…å«ç§æœ‰ä»“åº“çš„æäº¤è®°å½•
- âœ… **ä»£ç å®Œå…¨åŒæ­¥**ï¼šæ‰€æœ‰ä»£ç æ›´æ”¹éƒ½ä¼šåŒæ­¥
- âœ… **æäº¤ä¿¡æ¯æ±‡æ€»**ï¼šå·®å¼‚æœŸé—´çš„å¤šä¸ªæäº¤æ±‡æ€»ä¸ºä¸€ä¸ª
- âœ… **ç‹¬ç«‹æäº¤æ ‘**ï¼šå…¬å…±ä»“åº“æœ‰è‡ªå·±ç‹¬ç«‹çš„æäº¤å†å²
- âœ… **è‡ªåŠ¨è¿‡æ»¤æ–‡ä»¶**ï¼šè‡ªåŠ¨æ’é™¤ `.github/workflows/` ç›®å½•ï¼ˆå¯¹å…¬å…±ä»“åº“æ— æ„ä¹‰ï¼‰

## æäº¤ä¿¡æ¯æ ¼å¼

### é¦–æ¬¡åŒæ­¥ï¼ˆç©ºä»“åº“ï¼‰

å…¬å…±ä»“åº“å°†åˆ›å»º**ä¸€ä¸ªå…¨æ–°çš„åˆå§‹æäº¤**ï¼Œä¸åŒ…å«ä»»ä½•å†å²è®°å½•ï¼š

```
Initial commit: Zonix Operating System

Zonix is a minimal x86 operating system kernel featuring:

- Bootloader with protected mode initialization
- Memory management (PMM with first-fit, VMM with paging)
- Interrupt handling (IDT, PIC, PIT)
- Device drivers (CGA, keyboard, hard disk)
- Process scheduling framework
- Swap system with FIFO algorithm
- Shell console interface
- System call interface

Architecture: x86 (32-bit)
Build system: Make + GNU toolchain
Emulator support: Bochs, QEMU
```

ğŸ”’ **æ³¨æ„**ï¼šè¿™ä¸ªæäº¤æ˜¯å­¤ç«‹çš„ï¼ˆorphan commitï¼‰ï¼Œä¸åŒ…å«ç§æœ‰ä»“åº“çš„å†å²è®°å½•ã€‚

### å¢é‡åŒæ­¥ï¼ˆå·²æœ‰å†…å®¹ï¼‰

å°†å·®å¼‚æœŸé—´çš„å¤šä¸ªç§æœ‰æäº¤**æ±‡æ€»ä¸ºä¸€ä¸ªæ–°æäº¤**ï¼š

```
Sync from private repository

This commit consolidates changes from the private repository.

Changes summary:

- Add memory management improvements
- Fix VMM allocation bug
- Update documentation
- Refactor swap system

Files changed:
 kern/mm/pmm.c        | 45 ++++++++++++++++++++++++++++++++++++++++++
 kern/mm/vmm.c        | 23 +++++++++++++--------
 README.md            |  5 +++++
 3 files changed, 65 insertions(+), 8 deletions(-)
```

ğŸ”’ **æ³¨æ„**ï¼šç§æœ‰ä»“åº“çš„æäº¤å“ˆå¸Œã€ä½œè€…ä¿¡æ¯ã€æ—¶é—´æˆ³ç­‰éƒ½ä¸ä¼šæš´éœ²ã€‚

## æ³¨æ„äº‹é¡¹

âš ï¸ **é‡è¦æé†’**

1. é¦–æ¬¡è¿è¡Œå‰å¿…é¡»å®Œæˆ SSH å¯†é’¥é…ç½®
2. ç¡®ä¿å…¬å…±ä»“åº“å·²åˆ›å»ºå¹¶ä¸”å¯è®¿é—®
3. Dry Run æ¨¡å¼é€‚åˆåœ¨æ­£å¼åŒæ­¥å‰éªŒè¯æ›´æ”¹
4. å·¥ä½œæµä½¿ç”¨ `--force` æ¨é€ï¼Œä¼šè¦†ç›–å…¬å…±ä»“åº“çš„å†…å®¹
5. åŒæ­¥æ˜¯å•å‘çš„ï¼ˆç§æœ‰ â†’ å…¬å…±ï¼‰ï¼Œä¸ä¼šåå‘åŒæ­¥
6. **éšç§ä¿æŠ¤**ï¼šå…¬å…±ä»“åº“ä¸ä¼šåŒ…å«ç§æœ‰ä»“åº“çš„æäº¤å†å²
7. **ä»£ç åŒæ­¥**ï¼šæ‰€æœ‰ä»£ç å˜æ›´éƒ½ä¼šå®Œæ•´åŒæ­¥ï¼Œåªæ˜¯æäº¤è®°å½•è¢«åˆå¹¶
8. **è‡ªåŠ¨è¿‡æ»¤**ï¼š`.github/workflows/` ç›®å½•ä¼šè¢«è‡ªåŠ¨æ’é™¤ï¼Œä¸ä¼šåŒæ­¥åˆ°å…¬å…±ä»“åº“

## æ•…éšœæ’æŸ¥

### SSH è®¤è¯å¤±è´¥

```
Error: Permission denied (publickey)
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥ `PUBLIC_REPO_SSH_KEY` secret æ˜¯å¦æ­£ç¡®é…ç½®
- ç¡®è®¤å…¬å…±ä»“åº“çš„ Deploy Key å·²æ·»åŠ ä¸”å¯ç”¨å†™æƒé™

### æ²¡æœ‰æ£€æµ‹åˆ°å·®å¼‚

```
No differences found between repositories
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥ä¸¤ä¸ªä»“åº“çš„åˆ†æ”¯åç§°ï¼ˆmain vs masterï¼‰
- ç¡®è®¤ç§æœ‰ä»“åº“ç¡®å®æœ‰æ–°çš„æäº¤

### æ¨é€å¤±è´¥

```
Error: failed to push some refs
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥ Deploy Key çš„å†™æƒé™
- ç¡®è®¤å…¬å…±ä»“åº“æ²¡æœ‰å—ä¿æŠ¤çš„åˆ†æ”¯è§„åˆ™

## æ–‡ä»¶è¿‡æ»¤è§„åˆ™

### è‡ªåŠ¨æ’é™¤çš„æ–‡ä»¶

å·¥ä½œæµä¼šè‡ªåŠ¨æ’é™¤ä»¥ä¸‹æ–‡ä»¶/ç›®å½•ï¼Œå› ä¸ºå®ƒä»¬å¯¹å…¬å…±ä»“åº“æ²¡æœ‰æ„ä¹‰ï¼š

- âœ… `.github/workflows/` - GitHub Actions å·¥ä½œæµæ–‡ä»¶

### æ·»åŠ æ›´å¤šè¿‡æ»¤è§„åˆ™

å¦‚æœéœ€è¦æ’é™¤å…¶ä»–æ–‡ä»¶ï¼Œå¯ä»¥åœ¨å·¥ä½œæµçš„ "Create new commit with squashed changes" æ­¥éª¤ä¸­æ·»åŠ ï¼š

```bash
# ä¾‹å¦‚ï¼šæ’é™¤ç§æœ‰æ–‡æ¡£
git rm -rf docs/private/ 2>/dev/null || true
git reset HEAD docs/private/ 2>/dev/null || true

# ä¾‹å¦‚ï¼šæ’é™¤é…ç½®æ–‡ä»¶
git rm -f .env* 2>/dev/null || true
git reset HEAD .env* 2>/dev/null || true
```

## è‡ªå®šä¹‰é…ç½®

å¦‚æœéœ€è¦ä¿®æ”¹å·¥ä½œæµè¡Œä¸ºï¼Œå¯ä»¥ç¼–è¾‘ `.github/workflows/sync-to-public.yml`ï¼š

- ä¿®æ”¹æäº¤ä¿¡æ¯æ ¼å¼ï¼šç¼–è¾‘ `Generate consolidated commit message` æ­¥éª¤
- æ›´æ”¹æ¨é€ç­–ç•¥ï¼šä¿®æ”¹ `Push to public repository` æ­¥éª¤
- æ·»åŠ æ–‡ä»¶è¿‡æ»¤è§„åˆ™ï¼šåœ¨ `Create new commit with squashed changes` æ­¥éª¤ä¸­æ·»åŠ  `git rm` å‘½ä»¤
- æ·»åŠ é€šçŸ¥åŠŸèƒ½ï¼šåœ¨å·¥ä½œæµæœ«å°¾æ·»åŠ é€šçŸ¥æ­¥éª¤

## å®‰å…¨å»ºè®®

- ğŸ”’ å®šæœŸè½®æ¢ SSH å¯†é’¥
- ğŸ”’ ä½¿ç”¨ Deploy Key è€Œä¸æ˜¯ä¸ªäººè®¿é—®ä»¤ç‰Œ
- ğŸ”’ é™åˆ¶ Deploy Key ä»…ç”¨äºå¿…è¦çš„ä»“åº“
- ğŸ”’ å®¡æŸ¥åŒæ­¥çš„æ–‡ä»¶ï¼Œé¿å…æ³„éœ²æ•æ„Ÿä¿¡æ¯

## ç›¸å…³é“¾æ¥

- [GitHub Actions æ–‡æ¡£](https://docs.github.com/en/actions)
- [Deploy Keys è¯´æ˜](https://docs.github.com/en/developers/overview/managing-deploy-keys)
- [å·¥ä½œæµè¯­æ³•](https://docs.github.com/en/actions/using-workflows/workflow-syntax-for-github-actions)
